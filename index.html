<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arch. Sanjay Rajendra Koundarkar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        :root{
            /* Spotify-Inspired Theme Colors */
            --bg:#0e1217; 
            --card:#1a202c; 
            --accent:#1db954; /* Spotify Green */
            --muted:#98a0a8; 
            --glass: rgba(255,255,255,0.06);
            --radius:12px; 
            --transition:all .4s cubic-bezier(.2,.9,.3,1);
        }
        * { box-sizing: border-box; }
        html, body {
            height: 100%;
            margin: 0;
            font-family: 'Inter', system-ui, sans-serif;
            color: #e6eef6;
            background: var(--bg);
            -webkit-font-smoothing: antialiased;
            scroll-behavior: smooth;
            /* FIX: Ensure no unexpected horizontal overflow is visible */
            overflow-x: hidden; 
        }

        /* --- Keyframe Animation for Button Glow --- */
        @keyframes subtle-pulse {
            0% { box-shadow: 0 0 10px rgba(29, 185, 84, 0.6), 0 0 20px rgba(29, 185, 84, 0.3); }
            50% { box-shadow: 0 0 15px rgba(29, 185, 84, 0.8), 0 0 30px rgba(29, 185, 84, 0.5); }
            100% { box-shadow: 0 0 10px rgba(29, 185, 84, 0.6), 0 0 20px rgba(29, 185, 84, 0.3); }
        }

        /* --- Layout & Routing Styles (SPA Simulation) --- */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
        }
        .view-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 30px 20px;
            opacity: 0;
            transform: translateX(100%);
            transition: transform 0.6s cubic-bezier(.68, -0.55, 0.265, 1.55), opacity 0.5s ease-out;
            pointer-events: none;
        }
        .view-panel.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
            position: relative; 
        }
        .view-panel.slide-out-left {
            transform: translateX(-100%);
            opacity: 0;
            pointer-events: none;
        }
        
        /* --- Navigation Button Enhancements (Top Right) --- */
        #nav-projects {
            /* Ensure the glow is applied and the pulse animation is running */
            animation: subtle-pulse 3s infinite ease-in-out;
            border: 2px solid var(--accent); /* Extra visual separation */
            transition: var(--transition);
        }
        #nav-projects:hover {
            background: #14a046; /* Slightly darker green on hover */
            transform: scale(1.05); /* Pop out slightly */
            box-shadow: 0 0 20px rgba(29, 185, 84, 1), 0 0 40px rgba(29, 185, 84, 0.7);
        }
        
        /* --- Hero Card (Architect Profile) --- */
        .hero {
            display: flex;
            gap: 24px;
            align-items: center;
            background: linear-gradient(135deg, rgba(29, 185, 84, 0.1), rgba(2, 6, 23, 0.5));
            padding: 32px;
            border-radius: var(--radius);
            box-shadow: 0 15px 40px rgba(0,0,0,0.5);
            backdrop-filter: blur(8px);
            border: 1px solid var(--glass);
        }
        /* Profile Picture Size and Shape */
        .portrait {
            width: 250px; 
            height: 250px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 8px 30px rgba(0,0,0,0.8);
            border: 5px solid rgba(255,255,255,0.05);
            transition: var(--transition);
            
            /* GLOWING EFFECT FOR PROFILE PICTURE */
            filter: drop-shadow(0 0 15px rgba(29, 185, 84, 0.8)) drop-shadow(0 0 30px rgba(29, 185, 84, 0.4));
        }
        .portrait:hover { 
            transform: scale(1.05) rotate(-2deg); 
            filter: drop-shadow(0 0 20px rgba(29, 185, 84, 1)) drop-shadow(0 0 40px rgba(29, 185, 84, 0.6));
        }
        .portrait img { width: 100%; height: 100%; object-fit: cover; }
        
        /* GLOWING EFFECT FOR YELLOW TEXT */
        .hero .role .text-yellow-600 {
            text-shadow: 
                0 0 8px rgba(255, 230, 0, 0.9),
                0 0 18px rgba(255, 255, 0, 0.7);
            transition: text-shadow 0.3s ease-in-out;
        }

        /* GLOWING EFFECT FOR 18 YEARS OF EXPERIENCE */
        .hero .desc .text-green-400 {
            text-shadow: 
                0 0 8px rgba(29, 185, 84, 0.9),
                0 0 18px rgba(29, 185, 84, 0.7);
            transition: text-shadow 0.3s ease-in-out;
        }

        /* --- Featured Works Gallery --- */
        .featured-img {
            height: 200px;
            object-fit: cover;
            border: 3px solid transparent;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            transition: border-color 0.3s, transform 0.3s;
        }
        .featured-img:hover {
            border-color: var(--accent);
            transform: scale(1.02);
            cursor: zoom-in;
        }

        /* --- Projects Grid & Cards --- */
        .controls-bar {
            background: var(--card);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column; 
            gap: 12px;
        }
        #category-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px; 
        }
        .pill-button {
            background: var(--card);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 8px 16px; 
            border-radius: 999px;
            color: var(--muted);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.875rem; 
            flex-shrink: 0;
        }
        .pill-button.active {
            background: var(--accent);
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(29, 185, 84, 0.5);
            border-color: var(--accent);
        }
        .pill-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        .card {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: transform 0.3s, border 0.3s;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5), 0 0 10px var(--accent);
            border-color: var(--accent); 
        }
        .card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
            transition: transform 0.4s;
        }
        .card:hover img {
            transform: scale(1.05);
        }
        .caption {
            padding: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            color: #fff;
        }
        .caption .tag {
            font-size: 0.75rem;
            color: var(--muted);
            margin-top: 2px;
            font-weight: 400;
            opacity: 0.8;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        /* --- Modal Styling --- */
        #zoomModal {
            transition: opacity 0.3s, visibility 0.3s;
        }
        /* Smaller, circular, semi-transparent floating buttons */
        .fbtn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px; 
            height: 44px;
            border-radius: 50%; 
            font-size: 0.75rem;
            background: rgba(43, 43, 43, 0.7); /* Dark semi-transparent */
            color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            transition: all 0.2s;
            border: none;
            flex-shrink: 0;
            padding: 0;
        }
        .fbtn:hover {
            background: var(--accent);
            color: #000;
            transform: scale(1.05);
        }
        .fbtn-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        /* Navigation Arrows */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 100%;
            background: rgba(0, 0, 0, 0.0);
            color: white;
            font-size: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 51;
            transition: background 0.3s, opacity 0.3s;
            border: none;
            opacity: 0.7;
        }
        .nav-arrow:hover { background: rgba(29, 185, 84, 0.1); opacity: 1; }
        .nav-arrow:active { background: rgba(29, 185, 84, 0.3); }
        .nav-arrow.hidden { opacity: 0; pointer-events: none; }
        #prevBtn { left: 0; }
        #nextBtn { right: 0; }

        /* --- MOBILE ADJUSTMENTS (max-width: 768px) --- */
        @media (max-width: 768px) {
            
            /* --- 3. Navbar Restructure for Mobile --- */
            .app-container > nav > div {
                /* Container is flex and column on mobile */
                flex-direction: column;
                justify-content: center;
                align-items: center;
                gap: 0; /* Reset gap */
            }

            .app-container > nav > div > h1 {
                /* Title: Top Center */
                width: 100%; 
                text-align: center;
                margin-bottom: 12px; /* Space below title */
                font-size: 1.1rem;
            }
            
            .nav-mobile-buttons {
                /* New wrapper for buttons to align them */
                display: flex;
                width: 100%;
                justify-content: space-between; /* Pushes Profile to left, Projects to right */
                margin-top: 0;
                gap: 0; /* Buttons have their own padding/margin */
            }
            .nav-mobile-buttons .text-gray-400 {
                /* Profile button at top left */
                margin-right: auto;
            }
            .nav-mobile-buttons .bg-green-600 {
                /* View Projects button at top right */
                margin-left: auto;
            }


            /* --- 1. Profile Picture: Centered in Hero Card --- */
            .hero { 
                flex-direction: column; 
                align-items: center; /* Center everything vertically in column layout */
                padding: 20px; 
                text-align: center; /* Center text within the info block */
            }
            
            .portrait { 
                width: 180px; 
                height: 180px; 
                border-radius: 50%; 
                margin: 0 auto 10px auto; /* Center the profile image horizontally */
            }
            
            /* --- 2. Text/Content Alignment Fix (Inside Hero Card) --- */
            .hero .info {
                width: 100%; /* Ensure info container uses full width */
                display: flex; /* Use flex to align children */
                flex-direction: column;
                align-items: center; /* Center text blocks/buttons */
                text-align: center; 
            }

            .hero .info h1 {
                font-size: 1.5rem; 
                line-height: 1.2;
                white-space: nowrap;
                /* Allow overflow for safety, but rely on font size reduction */
                overflow: hidden; 
                text-overflow: ellipsis;
                width: 100%;
                text-align: center; /* Ensure name is centered */
            }
            
            .hero .info .role,
            .hero .info .desc {
                text-align: center;
                width: 100%;
            }

            .hero .info .flex-wrap {
                 /* Center the button group */
                 justify-content: center;
                 width: 100%;
            }
            
            /* General Mobile Gallery/Grid Adjustments */
            .gallery { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
            .card img { height: 120px; }
            .featured-img { height: 120px; }
            .controls-bar { align-items: stretch; }
            .nav-arrow { width: 40px; }
            #project-search { margin-top: 5px; } 
        }
    </style>
</head>
<body>
    <div class="app-container">
        
        <nav class="sticky top-0 z-20 bg-gray-900/80 backdrop-blur-sm p-4 shadow-2xl">
            <div class="flex justify-between items-center max-w-7xl mx-auto">
                <h1 class="text-xl font-bold text-white tracking-widest"> <span class="text-green-600"> ARCH. </span>S. R. KOUNDARKAR </h1>
                
                <div class="space-x-4 flex-shrink-0 nav-mobile-buttons">
                    <button id="nav-home" class="text-gray-400 hover:text-white transition-colors font-medium">Profile</button>
                    <button id="nav-projects" class="text-black bg-green-600 px-4 py-2 rounded-lg font-bold shadow-lg shadow-green-600/50">
                        View Projects
                    </button>
                </div>
            </div>
        </nav>

        <section class="view-panel active" id="home-view">
            <div class="hero">
                <div class="portrait">
                    <img src="Images/Sanjay.jpeg" alt="Architect Sanjay R. Koundarkar Portrait" onerror="this.onerror=null;this.src='https://placehold.co/250x250/374151/white?text=Portrait+Missing';"> 
                </div>
                <div class="info">
                    <h1 class="text-3xl sm:text-4xl font-extrabold">Mr. Sanjay Rajendra Koundarkar</h1>
                    <div class="text-xl role"><span class="text-yellow-600"><bold>Architect | Residential, Commercial, Temple Interior & Exterior</bold></span></div>
                
                    <p class="desc mt-3 text-gray-300">
                        Experienced architect specializing in blending modern aesthetics with cultural and traditional Indian design principles, with <strong class="text-green-400 font-extrabold text-lg">15 YEARS OF EXPERIENCE</strong>. Our expertise spans residential and commercial interiors, exteriors, sacred temple architecture, and specialized stone structures. We focus on creating sustainable, sensitive, and enduring spaces across Maharashtra and India.
                    </p>
                    
                    <div class="flex flex-wrap gap-3 mt-6">
                        <a href="tel:+919890542067" class="flex items-center space-x-2 px-4 py-3 rounded-full bg-gray-700 text-green-400 font-bold hover:bg-gray-600 transition-all shadow-lg active:scale-95">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.373 18 2 12.627 2 6V3z" /></svg>
                            <span>Call: +91 98905 42067</span>
                        </a>
                        
                        <a href="https://wa.me/919890542067" target="_blank" class="flex items-center space-x-2 px-4 py-3 rounded-full bg-green-600 text-black font-extrabold hover:bg-green-500 transition-all shadow-xl shadow-green-600/50 active:scale-95">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12.036 2.015c-5.52 0-9.99 4.47-9.99 9.99 0 1.76-.45 3.39-1.22 4.83l-1.82 6.6 6.75-1.77c1.47.78 3.16 1.22 4.67 1.22 5.52 0 9.99-4.47 9.99-9.99s-4.47-9.99-9.99-9.99zm-4.75 5.5l-.35.85c-.34.82-.53 1.69-.53 2.59 0 3.32 2.7 6.02 6.02 6.02 1.54 0 3-.56 4.1-1.5l.38-.34-.8-.92-.22-.27c-.85.83-1.89 1.28-3.05 1.28-2.3 0-4.17-1.87-4.17-4.17 0-.9.28-1.74.77-2.45l.28-.43-.8-.92c-.37-.4-.84-.87-1.37-1.37zm1.6 3.92c.1.25.1.52 0 .77l-.63 1.5c-.09.22-.09.46 0 .68l.2.46c.14.3.4.5.7.5.3 0 .56-.1.7-.4l.63-1.5c.09-.22.09-.46 0-.68l-.2-.46c-.14-.3-.4-.5-.7-.5-.3 0-.56.1-.7.4z" fill="#000"/></svg>
                            <span>WhatsApp Now</span>
                        </a>
                        
                        <div class="flex items-center space-x-2 px-4 py-3 rounded-full bg-gray-800 text-gray-400 font-medium border border-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>
                            <span>Based in Chiplun, India</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-10">
                <h2 class="text-2xl font-bold mb-4 text-white border-l-4 border-green-600 pl-3">Popular Featured Works</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <img src="Images/Home-Interior-and-exterior/na.jpeg" alt="Featured Work 1: Home Interior" class="featured-img rounded-lg" onclick="openModal('Images/Home-Interior-and-exterior/na.jpeg')">
                    <img src="Images/Triangle-Shaped/ccc.jpeg" alt="Featured Work 2: Farmhouse" class="featured-img rounded-lg" onclick="openModal('Images/Triangle-Shaped/ccc.jpeg')">
                </div>
                <button id="goto-projects-btn" class="w-full mt-8 view-projects px-6 py-4 bg-green-600 text-black font-extrabold rounded-lg text-lg shadow-xl shadow-green-600/30 hover:bg-green-500 transition-transform active:scale-95" style="animation: subtle-pulse 3s infinite ease-in-out; border: 2px solid var(--accent);">
                    View Complete Project Gallery →
                </button>
            </div>
        </section>

        <section id="projects-view" class="view-panel">
            <div class="flex justify-between items-center mb-6 border-b border-gray-700 pb-3">
                <h2 class="text-3xl font-bold text-white">Project Gallery</h2>
                <button id="back-to-home-btn" class="flex items-center space-x-2 text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" /></svg>
                    <span>Back to Profile</span>
                </button>
            </div>

            <div class="controls-bar">
                <div class="flex flex-wrap items-center gap-2">
                    <span class="text-sm text-white font-semibold flex-shrink-0">Filter by:</span>
                    <div id="category-list" class="flex flex-wrap gap-2">
                        </div>
                </div>
                <input type="text" id="project-search" placeholder="Search projects by tag or title..." class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-green-500 focus:ring focus:ring-green-500/50 transition-all">
            </div>
            
            <p id="description" class="text-gray-400 mb-6 border-l-4 border-green-600 pl-3 italic">Select a category to explore our wide range of work.</p>

            <div class="gallery" id="gallery">
                </div>
        </section>

    </div>

    <div class="fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 transition-opacity duration-300 opacity-0 pointer-events-none" id="zoomModal" aria-hidden="true">
        <div class="relative w-full h-full flex items-center justify-center">
            
            <button id="prevBtn" class="nav-arrow" aria-label="Previous Image">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-10 h-10"><path fill-rule="evenodd" d="M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z" clip-rule="evenodd" /></svg>
            </button>
            
            <button id="nextBtn" class="nav-arrow" aria-label="Next Image">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-10 h-10"><path fill-rule="evenodd" d="M16.28 12.53a.75.75 0 000-1.06l-7.5-7.5a.75.75 0 00-1.06 1.06L14.69 12l-6.97 6.97a.75.75 0 101.06 1.06l7.5-7.5z" clip-rule="evenodd" /></svg>
            </button>
            
            <img id="zoomImg" src="" alt="zoomed project image" class="max-w-full max-h-full object-contain cursor-grab transition-transform duration-100" style="transform-origin: center center;">
            
            <div class="absolute bottom-6 right-6 fbtn-group" id="zoom-controls">
                <button class="fbtn" id="zoomIn" title="Zoom In">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" /><path d="M10 6a.75.75 0 01.75.75v1.5h1.5a.75.75 0 010 1.5h-1.5v1.5a.75.75 0 01-1.5 0v-1.5h-1.5a.75.75 0 010-1.5h1.5v-1.5A.75.75 0 0110 6z" /></svg>
                </button>
                <button class="fbtn" id="zoomOut" title="Zoom Out">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" /><path d="M6.75 9.25a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5z" /></svg>
                </button>
                <button class="fbtn bg-red-600/70 hover:bg-red-500" id="closeModal" title="Close">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z" clip-rule="evenodd" /></svg>
                </button>
            </div>
        </div>
    </div>
    
    <div id="loading-indicator" class="fixed inset-0 bg-gray-900/90 z-[60] flex flex-col items-center justify-center text-white text-lg transition-opacity duration-300 pointer-events-none opacity-0">
        <svg xmlns="http://www.w3.org/2000/svg" class="animate-spin -ml-1 mr-3 h-10 w-10 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" /></svg>
        Loading Portfolio...
    </div>

<script>
    // Utility for placeholder/fallback image URL
    const getPlaceholder = (text) => 
        `https://placehold.co/600x400/374151/white?text=${encodeURIComponent(text.substring(0, 30).trim().replace(/-/g, ' '))}`;

    // --- PROJECT DATA STRUCTURE WITH CORRECTED RELATIVE PATHS ---
    const DATA = {
        "Interiors":{
        desc:"A comprehensive gallery showcasing diverse interior design styles—from minimalist to luxurious traditional Indian themes—for residential and commercial spaces.",
        images:[
            { src: "Images/All-Interiors/30.jpeg", tag: "mirror work" }, { src: "Images/All-Interiors/56.jpeg", tag: "eclectic mix" },
            { src: "Images/All-Interiors/3.jpeg", tag: "bedroom modern" }, { src: "Images/All-Interiors/86.jpeg", tag: "retail store" }, 
            { src: "Images/All-Interiors/91.jpeg", tag: "clubhouse interior" },{ src: "Images/All-Interiors/6.jpeg", tag: "wardrobe design" },
            { src: "Images/All-Interiors/7.jpeg", tag: "commercial office" }, { src: "Images/All-Interiors/8.jpeg", tag: "tv unit panel" },
            { src: "Images/All-Interiors/9.jpeg", tag: "wall texture" }, { src: "Images/All-Interiors/10.jpeg", tag: "false ceiling" },
            { src: "Images/All-Interiors/11.jpeg", tag: "residential bathroom" }, { src: "Images/All-Interiors/12.jpeg", tag: "staircase design" },
            { src: "Images/All-Interiors/13.jpeg", tag: "wooden finish" }, { src: "Images/All-Interiors/14.jpeg", tag: "kids room" },
            { src: "Images/All-Interiors/15.jpeg", tag: "pantry area" }, { src: "Images/All-Interiors/16.jpeg", tag: "bar counter" },
            { src: "Images/All-Interiors/17.jpeg", tag: "study table" }, { src: "Images/All-Interiors/18.jpeg", tag: "home theater" },
            { src: "Images/All-Interiors/19.jpeg", tag: "guest room" }, { src: "Images/All-Interiors/20.jpeg", tag: "master bedroom" },
            { src: "Images/All-Interiors/21.jpeg", tag: "small apartment" }, { src: "Images/All-Interiors/22.jpeg", tag: "open plan" },
            { src: "Images/All-Interiors/23.jpeg", tag: "partition wall" }, { src: "Images/All-Interiors/24.jpeg", tag: "ambient lighting" },
            { src: "Images/All-Interiors/25.jpeg", tag: "balcony seating" }, { src: "Images/All-Interiors/26.jpeg", tag: "traditional motif" },
            { src: "Images/All-Interiors/27.jpeg", tag: "storage solutions" }, { src: "Images/All-Interiors/28.jpeg", tag: "high end finish" },
            { src: "Images/All-Interiors/29.jpeg", tag: "ceramic tile" }, { src: "Images/All-Interiors/1.jpeg", tag: "living room luxury" },
            { src: "Images/All-Interiors/31.jpeg", tag: "lobby design" }, { src: "Images/All-Interiors/32.jpeg", tag: "reception area" },
            { src: "Images/All-Interiors/33.jpeg", tag: "meeting room" }, { src: "Images/All-Interiors/34.jpeg", tag: "lounge seating" },
            { src: "Images/All-Interiors/35.jpeg", tag: "executive cabin" }, { src: "Images/All-Interiors/36.jpeg", tag: "library design" },
            { src: "Images/All-Interiors/37.jpeg", tag: "artwork placement" }, { src: "Images/All-Interiors/38.jpeg", tag: "texture play" },
            { src: "Images/All-Interiors/39.jpeg", tag: "indoor plants" }, { src: "Images/All-Interiors/40.jpeg", tag: "natural light" },
            { src: "Images/All-Interiors/41.jpeg", tag: "minimalist style" }, { src: "Images/All-Interiors/42.jpeg", tag: "color palette" },
            { src: "Images/All-Interiors/43.jpeg", tag: "geometric patterns" }, { src: "Images/All-Interiors/44.jpeg", tag: "accent furniture" },
            { src: "Images/All-Interiors/45.jpeg", tag: "floating shelves" }, { src: "Images/All-Interiors/46.jpeg", tag: "false ceiling" },
            { src: "Images/All-Interiors/47.jpeg", tag: "custom cabinetry" }, { src: "Images/All-Interiors/48.jpeg", tag: "marble flooring" },
            { src: "Images/All-Interiors/49.jpeg", tag: "metal finishes" }, { src: "Images/All-Interiors/50.jpeg", tag: "contemporary" },
            { src: "Images/All-Interiors/51.jpeg", tag: "classic design" }, { src: "Images/All-Interiors/52.jpeg", tag: "rustic charm" },
            { src: "Images/All-Interiors/53.jpeg", tag: "industrial look" }, { src: "Images/All-Interiors/54.jpeg", tag: "scandinavian" },
            { src: "Images/All-Interiors/55.jpeg", tag: "Maharashtra is great" }, { src: "Images/All-Interiors/2.jpeg", tag: "kitchen modular" },
            { src: "Images/All-Interiors/57.jpeg", tag: "mid-century modern" }, { src: "Images/All-Interiors/58.jpeg", tag: "coastal theme" },
            { src: "Images/All-Interiors/59.jpeg", tag: "Maharashtra is great" }, { src: "Images/All-Interiors/60.jpeg", tag: "north indian style" },
            { src: "Images/All-Interiors/61.jpeg", tag: "maharashtrian design" }, { src: "Images/All-Interiors/62.jpeg", tag: "gujarati influence" },
            { src: "Images/All-Interiors/63.jpeg", tag: "rajasthani elements" }, { src: "Images/All-Interiors/64.jpeg", tag: "punjabi interior" },
            { src: "Images/All-Interiors/65.jpeg", tag: "Maharashtra is great" }, { src: "Images/All-Interiors/66.jpeg", tag: "bengali aesthetics" },
            { src: "Images/All-Interiors/67.jpeg", tag: "Maharashtra is great" }, { src: "Images/All-Interiors/68.jpeg", tag: "kolkata flat" },
            { src: "Images/All-Interiors/69.jpeg", tag: "mumbai apartment" }, { src: "Images/All-Interiors/70.jpeg", tag: "delhi villa" },
            { src: "Images/All-Interiors/71.jpeg", tag: "Maharashtra is great" }, { src: "Images/All-Interiors/72.jpeg", tag: "Maharashtra is great" },
            { src: "Images/All-Interiors/73.jpeg", tag: "pune property" }, { src: "Images/All-Interiors/74.jpeg", tag: "goa beach house" },
            { src: "Images/All-Interiors/75.jpeg", tag: "office pantry" }, { src: "Images/All-Interiors/76.jpeg", tag: "conference room" },
            { src: "Images/All-Interiors/77.jpeg", tag: "workstation design" }, { src: "Images/All-Interiors/78.jpeg", tag: "breakout area" },
            { src: "Images/All-Interiors/79.jpeg", tag: "training room" }, { src: "Images/All-Interiors/80.jpeg", tag: "server room" },
            { src: "Images/All-Interiors/81.jpeg", tag: "data center" }, { src: "Images/All-Interiors/82.jpeg", tag: "security cabin" },
            { src: "Images/All-Interiors/83.jpeg", tag: "gym interior" }, { src: "Images/All-Interiors/84.jpeg", tag: "spa design" },
            { src: "Images/All-Interiors/85.jpeg", tag: "salon interior" }, { src: "Images/All-Interiors/5.jpeg", tag: "entryway lighting" },
            { src: "Images/All-Interiors/87.jpeg", tag: "boutique design" }, { src: "Images/All-Interiors/88.jpeg", tag: "restaurant design" },
            { src: "Images/All-Interiors/89.jpeg", tag: "cafe interior" }, { src: "Images/All-Interiors/90.jpeg", tag: "bar lounge" },
            { src: "Images/All-Interiors/93.jpeg", tag: "community hall" }, { src: "Images/All-Interiors/4.jpeg", tag: "dining area" },
            { src: "Images/All-Interiors/94.jpeg", tag: "hotel lobby" }, { src: "Images/All-Interiors/95.jpeg", tag: "resort room" },
            { src: "Images/All-Interiors/96.jpeg", tag: "hospitality" }, { src: "Images/All-Interiors/912.jpeg", tag: "unique interior" }
        ]
        },
        "Exteriors":{
        desc:"Focus on facade design, landscaping, and exterior planning to ensure curb appeal, structural soundness, and aesthetic integration with the environment.",
        images:[
            { src: "Images/Exteriors/c9.jpeg", tag: "gate design" }, { src: "Images/Exteriors/c2.jpeg", tag: "villa exterior" },
            { src: "Images/Exteriors/c3.jpeg", tag: "apartment facade" }, { src: "Images/Exteriors/c4.jpeg", tag: "commercial building" },
            { src: "Images/Exteriors/c5.jpeg", tag: "compound wall design" },{ src: "Images/Exteriors/c6.jpeg", tag: "balcony railing" } ,
            { src: "Images/Exteriors/c14.jpeg", tag: "fountain feature" },{ src: "Images/Exteriors/c15.jpeg", tag: "landscape planning" },
            { src: "Images/Exteriors/c11.jpeg", tag: "outdoor lighting" },{ src: "Images/Exteriors/c10.jpeg", tag: "driveway paver" },
            { src: "Images/Exteriors/c1.jpeg", tag: "modern facade glass" }, { src: "Images/Exteriors/c12.jpeg", tag: "swimming pool" },
            { src: "Images/Exteriors/c13.jpeg", tag: "pergola seating" },{ src: "Images/Exteriors/c7.jpeg", tag: "terrace garden" },
            { src: "Images/Exteriors/c8.jpeg", tag: "portico design" }
        ]
        },
        "Home interior and exterior":{
            desc:"Complete custom home interior and exterior solutions, including modular kitchens, designer wardrobes, facade, and landscape integration for modern living.",
            images:[
                { src: "Images/Home-Interior-and-exterior/fa.jpeg", tag: "kitchen interior modular modern" },
                { src: "Images/Home-Interior-and-exterior/la.jpeg", tag: "wardrobe bedroom interior storage" },
                { src: "Images/Home-Interior-and-exterior/za.jpeg", tag: "living room interior furniture" },
                { src: "Images/Home-Interior-and-exterior/na.jpeg", tag: "modern facade exterior lighting" },
                { src: "Images/Home-Interior-and-exterior/qa.jpeg", tag: "balcony design landscape" },
                { src: "Images/Home-Interior-and-exterior/sa.jpeg", tag: "dining area custom" },
                { src: "Images/Home-Interior-and-exterior/ta.jpeg", tag: "bathroom vanity tile" }
            ]
        },
        "Temple interior and exterior":{
            desc:"Specialized work in sacred architecture, covering both the devotional interior layout and the magnificent exterior stonework of temples across India.",
            images:[
                { src: "Images/Temple-Interior-and-Exterior/abcd.jpeg", tag: "sacred carving stonework" },
                { src: "Images/Temple-Interior-and-Exterior/ac.jpeg", tag: "gopuram design architecture" },
                { src: "Images/Temple-Interior-and-Exterior/be.jpeg", tag: "interior mandap ceiling" },
                { src: "Images/Temple-Interior-and-Exterior/de.jpeg", tag: "exterior detail stone" },
                { src: "Images/Temple-Interior-and-Exterior/efgh.jpeg", tag: "traditional design vastu" },
                { src: "Images/Temple-Interior-and-Exterior/ijkl.jpeg", tag: "pillar detail craftsmanship" },
                { src: "Images/Temple-Interior-and-Exterior/mnop.jpeg", tag: "temple entrance facade" },
                { src: "Images/Temple-Interior-and-Exterior/ol.jpeg", tag: "altar design" },
                { src: "Images/Temple-Interior-and-Exterior/op.jpeg", tag: "prayer hall interior" },
                { src: "Images/Temple-Interior-and-Exterior/pq.jpeg", tag: "shikhara view" },
                { src: "Images/Temple-Interior-and-Exterior/qrst.jpeg", tag: "stone facade exterior" },
                { src: "Images/Temple-Interior-and-Exterior/sq.jpeg", tag: "interior lighting" },
                { src: "Images/Temple-Interior-and-Exterior/uvwx.jpeg", tag: "detailed carving" },
                { src: "Images/Temple-Interior-and-Exterior/yz.jpeg", tag: "final temple design" }
            ]
        },
        "Farm House work":{
            desc:"Unique farmhouse projects, including rustic and spacious designs, and specialized triangular-shaped structures integrated seamlessly with nature.",
            images:[
                { src: "Images/Triangle-Shaped/aaa.jpeg", tag: "farmhouse rustic nature" },
                { src: "Images/Triangle-Shaped/ccc.jpeg", tag: "triangular structure unique" },
                { src: "Images/Triangle-Shaped/ddd.jpeg", tag: "exterior design spacious" },
                { src: "Images/Triangle-Shaped/eee.jpeg", tag: "wooden cabin" },
                { src: "Images/Triangle-Shaped/fff.jpeg", tag: "modern barn" },
                { src: "Images/Triangle-Shaped/ggg.jpeg", tag: "landscape integration" },
                { src: "Images/Triangle-Shaped/hdu.jpeg", tag: "terrace view" },
                { src: "Images/Triangle-Shaped/hhh.jpeg", tag: "large windows" },
                { src: "Images/Triangle-Shaped/hjk.jpeg", tag: "poolside view" },
                { src: "Images/Triangle-Shaped/iii.jpeg", tag: "interior rustic" },
                { src: "Images/Triangle-Shaped/jjj.jpeg", tag: "kitchen farmhouse" },
                { src: "Images/Triangle-Shaped/kkk.jpeg", tag: "bedroom retreat" },
                { src: "Images/Triangle-Shaped/lll.jpeg", tag: "open concept" },
                { src: "Images/Triangle-Shaped/qqqq.jpeg", tag: "stone facade" },
                { src: "Images/Triangle-Shaped/nnn.jpeg", tag: "roof design" },
                { src: "Images/Triangle-Shaped/ooo.jpeg", tag: "modern farmhouse" },
                { src: "Images/Triangle-Shaped/ppp.jpeg", tag: "garden planning" },
                { src: "Images/Triangle-Shaped/qqq.jpeg", tag: "patio design" },
                { src: "Images/Triangle-Shaped/rrr.jpeg", tag: "sunset view" },
                { src: "Images/Triangle-Shaped/triangle.jpeg", tag: "geometry unique" },
                { src: "Images/Triangle-Shaped/vvv.jpeg", tag: "natural materials" }
            ]
        },
        "Chiplun Temple (On-going)":{
            desc:"Our signature ongoing temple project at Chiplun—focusing on intricate traditional detailing, stone finishes, and strict adherence to Vastu Shastra.",
            images:[
                { src: "Images/Chiplun-Temple/dq.jpeg", tag: "temple traditional stone vastu" },
                { src: "Images/Chiplun-Temple/fq.jpeg", tag: "mandap spiritual carving" },
                { src: "Images/Chiplun-Temple/lq.jpeg", tag: "sanctum detail ongoing" },
                { src: "Images/Chiplun-Temple/sq.jpeg", tag: "stone work exterior" },
                { src: "Images/Chiplun-Temple/tq.jpeg", tag: "shikhara design architecture" }
            ]
        },
        "Stone-structure for Tulsi":{
            desc:"Custom stone plinths and decorative structures for Tulsi, built with traditional craftsmanship and locally sourced stone materials.",
            images:[
                { src: "Images/Tulsi-work/abc.jpeg", tag: "tulsi stone plinth traditional" },
                { src: "Images/Tulsi-work/def.jpeg", tag: "decorative stone craftsmanship" },
                { src: "Images/Tulsi-work/ghi.jpeg", tag: "outdoor religious structure" }
            ]
        },
        "Real World 3D":{
            desc:"High-fidelity 3D real-world visualizations and renderings used for client presentations, marketing materials, and critical pre-construction review.",
            images:[
                { src: "Images/3D-real-world/100.jpeg", tag: "visualization rendering 3D exterior" },
                { src: "Images/3D-real-world/101.jpeg", tag: "3D rendering modern house" },
                { src: "Images/3D-real-world/102.jpeg", tag: "client presentation view" },
                { src: "Images/3D-real-world/103.jpeg", tag: "pre-construction review" },
                { src: "Images/3D-real-world/104.jpeg", tag: "night view rendering" },
                { src: "Images/3D-real-world/105.jpeg", tag: "interior visualization" },
                { src: "Images/3D-real-world/106.jpeg", tag: "landscape 3D model" },
                { src: "Images/3D-real-world/107.jpeg", tag: "commercial 3D" },
                { src: "Images/3D-real-world/108.jpeg", tag: "apartment rendering" },
                { src: "Images/3D-real-world/109.jpeg", tag: "architectural model" },
                { src: "Images/3D-real-world/NR-HR-111.jpg", tag: "high resolution rendering" },
                { src: "Images/3D-real-world/NR-HR-444.jpg", tag: "HR rendering commercial" },
                { src: "Images/3D-real-world/NR-HR-666.jpg", tag: "HR rendering facade" },
                { src: "Images/3D-real-world/NR-HR-888.jpg", tag: "HR rendering detail" }
            ]
        },
        "Building Constructions":{
            desc:"Large-scale building projects—structural planning, execution supervision, and exterior design. Focused on modern and robust structural integrity.",
            images:[
                { src: "Images/Building-construction/fa.jpeg", tag: "structure planning facade modern" },
                { src: "Images/Building-construction/fc.jpeg", tag: "exterior design commercial robust" }
            ]
        }
    };
    // --- State & Initialization ---

    // Flatten data for search indexing
    const ALL_PROJECTS = Object.entries(DATA).flatMap(([category, content]) => 
        content.images.map(img => ({
            category: category,
            desc: content.desc,
            src: img.src,
            tags: img.tag.toLowerCase(),
            title: category, 
            searchIndex: `${category.toLowerCase()} ${content.desc.toLowerCase()} ${img.tag.toLowerCase()}`
        }))
    );

    // DOM Elements & State
    const catList = document.getElementById('category-list');
    const gallery = document.getElementById('gallery');
    const descEl = document.getElementById('description');
    const searchInput = document.getElementById('project-search');
    const homeView = document.getElementById('home-view');
    const projectsView = document.getElementById('projects-view');
    const zoomModal = document.getElementById('zoomModal');
    const zoomImg = document.getElementById('zoomImg');
    const loadingIndicator = document.getElementById('loading-indicator');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    let currentCategory = null;
    let currentFilteredProjects = ALL_PROJECTS; // The list of images currently visible in the gallery
    let currentIndex = -1; // Index of the currently open image in currentFilteredProjects
    let zoomScale = 1;
    let isDragging = false;
    let startX, startY, currentX = 0, currentY = 0;
    const SWIPE_THRESHOLD = 50;
    let touchStartX = 0;

    // --- Router and Navigation (SPA Simulation) ---
    function navigate(viewId) {
        if (viewId === 'home') {
            projectsView.classList.remove('active');
            projectsView.classList.add('slide-out-left');
            
            homeView.classList.remove('slide-out-left');
            homeView.classList.add('active');
            window.location.hash = '#home';
        } else if (viewId === 'projects') {
            homeView.classList.remove('active');
            homeView.classList.add('slide-out-left');
            
            projectsView.classList.remove('slide-out-left');
            projectsView.classList.add('active');
            window.location.hash = '#projects';
            
            // CRITICAL: Ensure pills are always rendered and filtered when navigating here
            renderPills();
        }
    }

    window.addEventListener('hashchange', () => {
        const hash = window.location.hash.replace('#', '');
        if (hash === 'projects') {
            navigate('projects');
        } else {
            navigate('home');
        }
    });
    
    // Initial view setup
    const initialHash = window.location.hash.includes('projects');
    if (initialHash) {
        homeView.classList.remove('active');
        projectsView.classList.add('active');
    } else {
        homeView.classList.add('active');
        projectsView.classList.remove('active');
    }


    // Attach Nav Events
    document.getElementById('nav-home').addEventListener('click', () => navigate('home'));
    document.getElementById('back-to-home-btn').addEventListener('click', () => navigate('home'));
    document.getElementById('nav-projects').addEventListener('click', () => navigate('projects'));
    document.getElementById('goto-projects-btn').addEventListener('click', () => navigate('projects'));

    // --- Gallery Logic ---

    function renderPills() {
        const categories = Object.keys(DATA);
        
        // Set default category if none is selected
        if (!currentCategory) {
            currentCategory = categories[0];
        }
        
        catList.innerHTML = '';
        
        categories.forEach((cat) => {
            const b = document.createElement('button');
            b.className = 'pill-button';
            if (cat === currentCategory) b.classList.add('active');
            b.textContent = cat;
            b.setAttribute('data-category', cat);
            // Ensure filterGallery is called after category is set
            b.addEventListener('click', (e) => selectCategory(cat, e.target));
            catList.appendChild(b);
        });

        // Always filter after rendering pills to ensure the gallery matches the active pill
        filterGallery();
    }

    function selectCategory(cat, btn) {
        currentCategory = cat;
        
        document.querySelectorAll('.pill-button').forEach(p => p.classList.remove('active'));
        if (btn) btn.classList.add('active');
        
        descEl.textContent = DATA[cat].desc || '';
        
        searchInput.value = '';
        
        filterGallery();
    }

    function createCard(project) {
        const card = document.createElement('div');
        card.className = 'card';

        const img = document.createElement('img');
        img.loading = 'lazy';
        img.src = project.src;
        img.alt = project.title;
        img.onerror = () => img.src = getPlaceholder(`Missing: ${project.src.split('/').pop()}`); 

        // Important: Attach the modal open event with the image src
        img.addEventListener('click', () => openModal(project.src));

        const caption = document.createElement('div');
        caption.className = 'caption';
        caption.innerHTML = `
            ${project.title}
            <div class="tag">${project.tags.split(' ').slice(0, 3).join(' | ')}</div>
        `;
        
        card.appendChild(img);
        card.appendChild(caption);
        return card;
    }

    function filterGallery() {
        gallery.innerHTML = '';
        const searchTerm = searchInput.value.toLowerCase().trim();
        
        // 1. Determine the source data based on the current category
        const projectsInCurrentCategory = ALL_PROJECTS.filter(p => p.category === currentCategory);

        // 2. Apply search filter
        currentFilteredProjects = projectsInCurrentCategory.filter(project => 
            project.searchIndex.includes(searchTerm)
        );

        if (currentFilteredProjects.length === 0) {
            gallery.innerHTML = '<p class="text-gray-500 col-span-full p-6 text-center text-lg">No projects found matching the selected category and search term. Try a different filter!</p>';
        } else {
            currentFilteredProjects.forEach(project => {
                gallery.appendChild(createCard(project));
            });
        }
        
        // Update description based on the active category for visual confirmation
        descEl.textContent = DATA[currentCategory]?.desc || 'Select a category to explore our wide range of work.';
    }

    // Attach Search Event 
    searchInput.addEventListener('input', filterGallery);

    // --- Modal/Zoom/Navigation Logic ---
    
    // Resets zoom and pan state
    function resetTransform() {
        zoomScale = 1;
        currentX = 0;
        currentY = 0;
        applyTransform();
        zoomImg.style.cursor = 'grab';
    }

    function applyTransform() { 
        zoomImg.style.transform = `scale(${zoomScale}) translate(${currentX}px, ${currentY}px)`; 
    }

    function loadModalImage(src) {
        zoomImg.src = src;
        resetTransform();
    }

    function openModal(src) {
        // 1. Find the index of the clicked image in the current filtered list
        currentIndex = currentFilteredProjects.findIndex(p => p.src === src);

        // 2. Load the image and display modal
        loadModalImage(src);
        zoomModal.classList.add('opacity-100', 'pointer-events-auto');
        zoomModal.setAttribute('aria-hidden','false');
        
        // 3. Update navigation buttons
        updateNavButtonVisibility();
    }
    
    function closeModal() { 
        zoomModal.classList.remove('opacity-100', 'pointer-events-auto'); 
        zoomModal.setAttribute('aria-hidden','true');
        currentIndex = -1; 
    }

    function updateNavButtonVisibility() {
        if (currentIndex <= 0) {
            prevBtn.classList.add('hidden');
        } else {
            prevBtn.classList.remove('hidden');
        }

        if (currentIndex >= currentFilteredProjects.length - 1) {
            nextBtn.classList.add('hidden');
        } else {
            nextBtn.classList.remove('hidden');
        }
    }

    function navigateImage(direction) {
        // direction: 1 for next, -1 for previous
        if (currentFilteredProjects.length === 0 || currentIndex === -1) return;

        let newIndex = currentIndex + direction;

        if (newIndex >= 0 && newIndex < currentFilteredProjects.length) {
            currentIndex = newIndex;
            loadModalImage(currentFilteredProjects[currentIndex].src);
        }
        updateNavButtonVisibility();
    }
    
    // Attach buttons events
    document.getElementById('zoomIn').addEventListener('click', () => { zoomScale = Math.min(zoomScale + 0.2, 5); applyTransform(); });
    document.getElementById('zoomOut').addEventListener('click', () => { zoomScale = Math.max(zoomScale - 0.2, 0.5); if(zoomScale < 1) { resetTransform(); } else { applyTransform(); } });
    document.getElementById('closeModal').addEventListener('click', closeModal);
    prevBtn.addEventListener('click', () => navigateImage(-1));
    nextBtn.addEventListener('click', () => navigateImage(1));


    // Close on backdrop click
    zoomModal.addEventListener('click', (e) => { 
        if (e.target === zoomModal) { 
            closeModal(); 
        } 
    });
    
    // --- Touch/Mouse Pan & Zoom Logic ---

    // Mouse Down / Touch Start Handler
    const startInteraction = (e) => {
        if (zoomScale > 1) {
            // Prioritize PANNING if zoomed in
            e.preventDefault();
            isDragging = true;
            startX = e.clientX !== undefined ? e.clientX : e.touches[0].clientX;
            startY = e.clientY !== undefined ? e.clientY : e.touches[0].clientY;
            zoomImg.style.cursor = 'grabbing';
        } else if (e.touches && e.touches.length === 1) {
             // Prioritize SWIPE if not panning
             touchStartX = e.touches[0].clientX;
        }
    };

    zoomImg.addEventListener('mousedown', startInteraction);
    zoomImg.addEventListener('touchstart', startInteraction, { passive: false });

    // Move Handler
    const moveInteraction = (e) => {
        if (isDragging && zoomScale > 1) {
            const clientX = e.clientX !== undefined ? e.clientX : e.touches[0].clientX;
            const clientY = e.clientY !== undefined ? e.clientY : e.touches[0].clientY;

            const dx = clientX - startX;
            const dy = clientY - startY;
            
            currentX += dx;
            currentY += dy;
            
            startX = clientX;
            startY = clientY;
            
            applyTransform();
        }
    }

    window.addEventListener('mousemove', moveInteraction);
    window.addEventListener('touchmove', moveInteraction, { passive: false });


    // End Drag / Touch End Handler (Handles both Panning stop and Swipe detection)
    const endInteraction = (e) => {
        if (isDragging) {
            // PANNING Stop
            isDragging = false;
            zoomImg.style.cursor = zoomScale > 1 ? 'grab' : 'default';
        } else if (touchStartX !== 0 && zoomScale === 1 && e.changedTouches) {
            // SWIPE detection (only if not panning and scale is 1)
            const touchEndX = e.changedTouches[0].clientX;
            const deltaX = touchEndX - touchStartX;
            
            if (Math.abs(deltaX) > SWIPE_THRESHOLD) {
                if (deltaX > 0) {
                    navigateImage(-1); // Swiped right (show previous)
                } else {
                    navigateImage(1); // Swiped left (show next)
                }
            }
        }
        touchStartX = 0;
    }

    window.addEventListener('mouseup', endInteraction);
    window.addEventListener('touchend', endInteraction);

    // Wheel zoom
    zoomImg.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = -Math.sign(e.deltaY) * 0.2;
        zoomScale = Math.min(Math.max(0.5, zoomScale + delta), 8);
        if(zoomScale < 1) { resetTransform(); }
        applyTransform();
    }, { passive: false });

    // Keyboard navigation (Escape to close, Arrows for nav)
    window.addEventListener('keydown', (e) => {
        if (zoomModal.classList.contains('opacity-100')) {
            if (e.key === 'Escape') {
                closeModal();
            } else if (e.key === 'ArrowLeft') {
                navigateImage(-1);
            } else if (e.key === 'ArrowRight') {
                navigateImage(1);
            }
        }
    });

    // --- Initialization ---
    function initialize() {
        loadingIndicator.classList.add('opacity-100', 'pointer-events-auto');
        
        setTimeout(() => {
            // FIX: Set the initial category immediately
            currentCategory = Object.keys(DATA)[0]; 

            if (initialHash) {
                // If starting directly on #projects, render pills
                renderPills();
            } else {
                 // Even if starting on home view, filter the first category so currentFilteredProjects is ready for the modal
                 filterGallery(); 
            }
            loadingIndicator.classList.remove('opacity-100', 'pointer-events-auto');
        }, 800); 
    }

    initialize();
</script>
</body>
</html>

